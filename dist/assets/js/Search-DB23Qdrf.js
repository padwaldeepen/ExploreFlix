var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,r,i)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i,l=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&s(e,r,t[r]);if(i)for(var r of i(t))a.call(t,r)&&s(e,r,t[r]);return e},c=(e,i)=>t(e,r(i));import{j as o,m as u,A as d}from"./animations-zlTdoH7j.js";import{r as h}from"./router-BOZkTABG.js";import{C as v}from"./ContentCard-BMrhgNJs.js";import{u as p}from"./useExploreFlix-M4JBBqNi.js";import{L as m}from"./index-Dn0s-eHs.js";import{S as j,X as x,b as y,c as _,d as f}from"./icons-DLPi5bHb.js";import"./vendor-Cx84Lukz.js";import"./exploreflixApi-C44BPbjv.js";const g={searchHeader:"_searchHeader_1kvvn_23",searchForm:"_searchForm_1kvvn_66",searchIcon:"_searchIcon_1kvvn_90",searchInput:"_searchInput_1kvvn_79",clearButton:"_clearButton_1kvvn_125",filterButton:"_filterButton_1kvvn_148",filterGroup:"_filterGroup_1kvvn_199",filterActions:"_filterActions_1kvvn_225",applyButton:"_applyButton_1kvvn_239",clearFiltersButton:"_clearFiltersButton_1kvvn_254",searchResults:"_searchResults_1kvvn_269",resultsTitle:"_resultsTitle_1kvvn_287",resultsGrid:"_resultsGrid_1kvvn_303",noResults:"_noResults_1kvvn_341",recentSearches:"_recentSearches_1kvvn_363",recentTitle:"_recentTitle_1kvvn_367",recentList:"_recentList_1kvvn_376",recentItem:"_recentItem_1kvvn_382",trendingSection:"_trendingSection_1kvvn_396",trendingTitle:"_trendingTitle_1kvvn_400",trendingGrid:"_trendingGrid_1kvvn_409",search:"_search_1kvvn_1"},N=()=>{const{trendingContent:e,searchContent:t}=p(),[r,i]=h.useState(""),[n,a]=h.useState([]),[s,N]=h.useState(!1),[k,b]=h.useState(!1),[S,C]=h.useState({type:"",genre:"",year:"",rating:""}),[T,A]=h.useState([]),G=h.useRef(null),w=((e,t)=>{const[r,i]=h.useState(e);return h.useEffect((()=>{const r=setTimeout((()=>{i(e)}),t);return()=>{clearTimeout(r)}}),[e,t]),r})(r,500);h.useEffect((()=>{const e=localStorage.getItem("recentSearches");e&&A(JSON.parse(e))}),[]),h.useEffect((()=>()=>{G.current&&clearTimeout(G.current)}),[]);const B=h.useCallback((e=>{if(!e.trim())return;const t=[e,...T.filter((t=>t!==e))].slice(0,5);A(t),localStorage.setItem("recentSearches",JSON.stringify(t))}),[T]),F=h.useCallback((e=>{return r=null,i=null,n=function*(){if(!e.trim())return a([]),void N(!1);N(!0);try{const r=yield t(e);a(r),B(e)}catch(r){a([])}finally{N(!1)}},new Promise(((e,t)=>{var a=e=>{try{l(n.next(e))}catch(r){t(r)}},s=e=>{try{l(n.throw(e))}catch(r){t(r)}},l=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,s);l((n=n.apply(r,i)).next())}));var r,i,n}),[t,B]);return h.useEffect((()=>{F(w)}),[w,F]),o.jsxs("div",{className:g.search,children:[o.jsx(u.div,{className:g.searchHeader,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:o.jsx("div",{className:g.searchContainer,children:o.jsxs("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&F(r)},className:g.searchForm,children:[o.jsxs("div",{className:g.searchInputWrapper,children:[o.jsx(j,{className:g.searchIcon,size:20}),o.jsx("input",{type:"text",placeholder:"Search for movies, series, anime...",value:r,onChange:e=>{const t=e.target.value;i(t),G.current&&clearTimeout(G.current),t.trim()?G.current=setTimeout((()=>{F(t)}),500):a([])},className:g.searchInput,autoFocus:!0}),r&&o.jsx("button",{type:"button",onClick:()=>{i(""),a([])},className:g.clearButton,"aria-label":"Clear search",children:o.jsx(x,{size:16})})]}),o.jsx("button",{type:"button",onClick:()=>b(!k),className:g.filterButton,"aria-label":"Toggle filters",children:o.jsx(y,{size:20})})]})})}),o.jsx(d,{children:k&&o.jsx(u.div,{className:g.filtersContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:o.jsxs("div",{className:g.filters,children:[o.jsxs("div",{className:g.filterGroup,children:[o.jsx("label",{children:"Type"}),o.jsxs("select",{value:S.type,onChange:e=>C((t=>c(l({},t),{type:e.target.value}))),children:[o.jsx("option",{value:"",children:"All Types"}),o.jsx("option",{value:"movie",children:"Movies"}),o.jsx("option",{value:"series",children:"Series"}),o.jsx("option",{value:"anime",children:"Anime"})]})]}),o.jsxs("div",{className:g.filterGroup,children:[o.jsx("label",{children:"Genre"}),o.jsxs("select",{value:S.genre,onChange:e=>C((t=>c(l({},t),{genre:e.target.value}))),children:[o.jsx("option",{value:"",children:"All Genres"}),(()=>{const e=new Set;return n.forEach((t=>{t.genre&&t.genre.split(", ").forEach((t=>e.add(t.trim())))})),Array.from(e).sort()})().map((e=>o.jsx("option",{value:e,children:e},e)))]})]}),o.jsxs("div",{className:g.filterGroup,children:[o.jsx("label",{children:"Year"}),o.jsxs("select",{value:S.year,onChange:e=>C((t=>c(l({},t),{year:e.target.value}))),children:[o.jsx("option",{value:"",children:"All Years"}),(()=>{const e=new Set(n.map((e=>e.year)).filter(Boolean));return Array.from(e).sort(((e,t)=>(t||"").localeCompare(e||"")))})().map((e=>o.jsx("option",{value:e,children:e},e)))]})]}),o.jsxs("div",{className:g.filterGroup,children:[o.jsx("label",{children:"Min Rating"}),o.jsxs("select",{value:S.rating,onChange:e=>C((t=>c(l({},t),{rating:e.target.value}))),children:[o.jsx("option",{value:"",children:"Any Rating"}),o.jsx("option",{value:"7",children:"7+"}),o.jsx("option",{value:"8",children:"8+"}),o.jsx("option",{value:"9",children:"9+"})]})]}),o.jsxs("div",{className:g.filterActions,children:[o.jsx("button",{onClick:()=>{if(!r.trim())return;let e=n;S.type&&(e=e.filter((e=>e.type===S.type))),S.genre&&(e=e.filter((e=>{var t;return null==(t=e.genre)?void 0:t.toLowerCase().includes(S.genre.toLowerCase())}))),S.year&&(e=e.filter((e=>e.year===S.year))),S.rating&&(e=e.filter((e=>parseFloat(e.rating||"0")>=parseFloat(S.rating)))),a(e),b(!1)},className:g.applyButton,children:"Apply Filters"}),o.jsx("button",{onClick:()=>{C({type:"",genre:"",year:"",rating:""}),r.trim()&&F(r)},className:g.clearFiltersButton,children:"Clear All"})]})]})})}),o.jsxs("div",{className:g.searchResults,children:[s&&o.jsx("div",{className:g.loadingContainer,children:o.jsx(m,{})}),!s&&r&&o.jsx(o.Fragment,{children:n.length>0?o.jsxs(u.div,{className:g.resultsContainer,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[o.jsxs("h2",{className:g.resultsTitle,children:["Found ",n.length," result",1!==n.length?"s":"",' for "',r,'"']}),o.jsx("div",{className:g.resultsGrid,children:n.map(((e,t)=>o.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:o.jsx(v,{item:e,variant:"default"})},e.id)))})]}):o.jsxs(u.div,{className:g.noResults,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[o.jsx("h2",{children:"No results found"}),o.jsx("p",{children:"Try searching for something else or check your spelling."})]})}),!r&&T.length>0&&o.jsxs(u.div,{className:g.recentSearches,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[o.jsxs("h3",{className:g.recentTitle,children:[o.jsx(_,{size:20}),"Recent Searches"]}),o.jsx("div",{className:g.recentList,children:T.map(((e,t)=>o.jsxs(u.button,{className:g.recentItem,onClick:()=>{i(e),F(e)},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},whileHover:{scale:1.05},whileTap:{scale:.95},children:[o.jsx(f,{size:16}),e]},e)))})]}),!r&&!s&&o.jsxs(u.div,{className:g.trendingSection,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:[o.jsx("h3",{className:g.trendingTitle,children:"Trending Now"}),o.jsx("div",{className:g.trendingGrid,children:e.slice(0,8).map(((e,t)=>o.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:o.jsx(v,{item:e,variant:"compact"})},e.id)))})]})]})]})};export{N as Search};
