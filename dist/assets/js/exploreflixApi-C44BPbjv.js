var e=(e,t,i)=>new Promise(((r,n)=>{var o=e=>{try{a(i.next(e))}catch(t){n(t)}},l=e=>{try{a(i.throw(e))}catch(t){n(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);a((i=i.apply(e,t)).next())}));const t="https://api.jikan.moe/v4",i="https://www.omdbapi.com",r="b9dadde8",n=e=>new Promise((t=>setTimeout(t,e))),o=(t,i=1,r=1e4)=>e(null,null,(function*(){for(let o=0;o<i;o++)try{const e=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Request timeout"))),r)})),i=fetch(t),l=yield Promise.race([i,e]);if(429===l.status){yield n(1e3*(o+1));continue}if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return yield l.json()}catch(e){if(o===i-1)return null;yield n(500*(o+1))}return null})),l=()=>e(null,null,(function*(){try{yield n(300);const i=[`${t}/top/anime?filter=airing&limit=4`,`${t}/top/anime?filter=bypopularity&limit=4`,`${t}/top/anime?filter=favorite&limit=4`].map(((t,i)=>e(null,null,(function*(){try{yield n(200*i);const e=yield o(t);return e&&e.data&&e.data||[]}catch(e){return[]}})))),r=(yield Promise.all(i)).flat();if(0===r.length)return[];const l=new Map;r.forEach((e=>{var t,i,r,n,o;const a=`anime-${e.mal_id}`;!l.has(a)&&e.synopsis&&(null==(i=null==(t=e.images)?void 0:t.jpg)?void 0:i.image_url)&&l.set(a,{id:a,title:e.title_english||e.title,plot:e.synopsis,poster:e.images.jpg.image_url,year:(null==(r=e.year)?void 0:r.toString())||"",genre:(null==(n=e.genres)?void 0:n.map((e=>e.name)).join(", "))||"",runtime:e.duration||"",rating:(null==(o=e.score)?void 0:o.toString())||"",type:"anime"})}));return Array.from(l.values()).slice(0,8)}catch(i){return[]}})),a=()=>e(null,null,(function*(){try{yield n(200);const t=["action","drama","comedy","thriller"],l=[];for(const a of t)try{const t=yield o(`${i}/?s=${encodeURIComponent(a)}&type=movie&apikey=${r}`);if("True"===t.Response&&t.Search)for(const a of t.Search.slice(0,2))try{const e=yield o(`${i}/?i=${a.imdbID}&apikey=${r}&plot=short`);if("True"===e.Response){const t={id:`movie-${e.imdbID}`,title:e.Title,plot:e.Plot,poster:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:e.Year,genre:e.Genre,runtime:e.Runtime,rating:e.imdbRating,type:"movie"};l.find((e=>e.id===t.id))||l.push(t)}yield n(200)}catch(e){}yield n(300)}catch(e){}return l.slice(0,8)}catch(e){return[]}})),s=t=>e(null,null,(function*(){try{yield n(500);const l=yield o(`${i}/?s=${encodeURIComponent(t)}&type=movie&apikey=${r}`);if("True"!==l.Response||!l.Search)return[];const a=[];for(const t of l.Search.slice(0,8))try{const e=yield o(`${i}/?i=${t.imdbID}&apikey=${r}&plot=short`);"True"===e.Response&&a.push({id:`movie-${e.imdbID}`,title:e.Title,plot:e.Plot,poster:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:e.Year,genre:e.Genre,runtime:e.Runtime,rating:e.imdbRating,type:"movie"}),yield n(300)}catch(e){}return a}catch(e){return[]}})),c=i=>e(null,null,(function*(){try{yield n(1e3);const e=yield o(`${t}/anime?q=${encodeURIComponent(i)}&limit=10`);if(!e||!e.data)return[];const r=new Map;return e.data.forEach((e=>{var t,i;const n=`anime-${e.mal_id}`;r.has(n)||r.set(n,{id:n,title:e.title_english||e.title,plot:e.synopsis,poster:e.images.jpg.image_url,year:(null==(t=e.year)?void 0:t.toString())||"",genre:e.genres.map((e=>e.name)).join(", "),runtime:e.duration,rating:(null==(i=e.score)?void 0:i.toString())||"",type:"anime"})})),Array.from(r.values())}catch(e){return[]}})),u=()=>e(null,null,(function*(){try{const[e,t]=yield Promise.all([a(),l()]),i=[...e,...t].filter((e=>e&&e.id&&e.title));return 0===i.length?[{id:"fallback-1",title:"Sample Movie",plot:"A sample movie description for demonstration purposes.",poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=Sample+Movie",year:"2024",genre:"Action, Adventure",runtime:"120 min",rating:"8.5",type:"movie"},{id:"fallback-2",title:"Sample Series",plot:"A sample series description for demonstration purposes.",poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=Sample+Series",year:"2024",genre:"Drama, Thriller",runtime:"45 min",rating:"8.2",type:"series"}]:i.sort((()=>Math.random()-.5)).slice(0,8)}catch(e){return[{id:"fallback-1",title:"Sample Movie",plot:"A sample movie description for demonstration purposes.",poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=Sample+Movie",year:"2024",genre:"Action, Adventure",runtime:"120 min",rating:"8.5",type:"movie"},{id:"fallback-2",title:"Sample Series",plot:"A sample series description for demonstration purposes.",poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=Sample+Series",year:"2024",genre:"Drama, Thriller",runtime:"45 min",rating:"8.2",type:"series"}]}})),p=t=>e(null,null,(function*(){try{yield n(500);const l=yield o(`${i}/?s=${encodeURIComponent(t)}&type=series&apikey=${r}`);if("True"!==l.Response||!l.Search)return[];const a=[];for(const t of l.Search.slice(0,8))try{const e=yield o(`${i}/?i=${t.imdbID}&apikey=${r}&plot=short`);"True"===e.Response&&a.push({id:`series-${e.imdbID}`,title:e.Title,plot:e.Plot,poster:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:e.Year,genre:e.Genre,runtime:e.Runtime,rating:e.imdbRating,type:"series"}),yield n(300)}catch(e){}return a}catch(e){return[]}})),m=t=>e(null,null,(function*(){try{const[e,i,r]=yield Promise.all([s(t),c(t),p(t)]);return[...e,...i,...r]}catch(e){return[]}})),d=()=>e(null,null,(function*(){return a()})),y=()=>e(null,null,(function*(){return l()})),h=()=>e(null,null,(function*(){try{yield n(200);const t=["drama","comedy","action","sci-fi"],l=[];for(const a of t)try{const t=yield o(`${i}/?s=${encodeURIComponent(a)}&type=series&apikey=${r}`);if("True"===t.Response&&t.Search)for(const a of t.Search.slice(0,2))try{const e=yield o(`${i}/?i=${a.imdbID}&apikey=${r}&plot=short`);if("True"===e.Response){const t={id:`series-${e.imdbID}`,title:e.Title,plot:e.Plot,poster:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:e.Year,genre:e.Genre,runtime:e.Runtime,rating:e.imdbRating,type:"series"};l.find((e=>e.id===t.id))||l.push(t)}yield n(200)}catch(e){}yield n(300)}catch(e){}return l.slice(0,8)}catch(e){return[]}})),F=(l,a)=>e(null,null,(function*(){var e,s,c,u,p,m,d,y;try{yield n(300);const h=l.replace(`${a}-`,"");if("movie"===a||"series"===a){const e=yield o(`${i}/?i=${h}&apikey=${r}&plot=full`);if("True"===e.Response)return{id:`${a}-${e.imdbID}`,title:e.Title,plot:e.Plot,poster:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:e.Year,genre:e.Genre,runtime:e.Runtime,rating:e.imdbRating,type:a,cast:e.Actors,director:e.Director}}else if("anime"===a){const i=yield o(`${t}/anime/${h}/full`);if(i&&i.data){const t=i.data;return{id:`anime-${t.mal_id}`,title:t.title_english||t.title,plot:t.synopsis,poster:(null==(s=null==(e=t.images)?void 0:e.jpg)?void 0:s.image_url)||"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=No+Image",year:(null==(c=t.year)?void 0:c.toString())||"",genre:(null==(u=t.genres)?void 0:u.map((e=>e.name)).join(", "))||"",runtime:t.duration||"",rating:(null==(p=t.score)?void 0:p.toString())||"",type:"anime",episodes:t.episodes,status:t.status,season:(null==(m=t.season)?void 0:m.year)?`${t.season.season} ${t.season.year}`:"",studio:(null==(y=null==(d=t.studios)?void 0:d[0])?void 0:y.name)||""}}}throw new Error("Content not found")}catch(h){return{id:l,title:"Content Not Found",plot:"This content could not be loaded. Please try again later.",poster:"https://via.placeholder.com/500x750/1A1A1A/FFFFFF?text=Not+Found",year:"",genre:"",runtime:"",rating:"",type:a}}}));export{h as a,y as b,u as c,F as d,d as g,m as s};
